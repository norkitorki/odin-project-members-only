<h1>Posts</h1>

<nav>
  <ul>
    <% if user_signed_in? %>
      <li><%= link_to 'Log Out', destroy_user_session_path, data: { turbo_method: :delete, turbo_confirm: 'Are you sure that you would like to log out?' } %></li>
      <li><%= link_to 'Edit User', edit_user_registration_path %></li>
    <% else %>
      <li><%= link_to 'Sign In', new_user_session_path %></li>
      <li><%= link_to 'Sign Up', new_user_registration_path %></li>
    <% end %>
  </ul>
</nav>

<% if user_signed_in? %>
  <%= render 'form', post: @post %>
<% end %>

<% (@posts || Post.all).order('created_at DESC').each do |post| %>
  <div>
    <p>
      <strong><%= post.title %></strong>
      <% if user_signed_in? %>
        by <%= post.user.username %>
      <% end %>
    </p>
    <p><%= post.body %></p>

    <div>
      <%= link_to 'Show', post %>
      <% if current_user && current_user.id == post.user.id %>
        <%= link_to 'Edit', edit_post_path(post) %>
        <%= link_to 'Delete', post_path(post), data: { turbo_method: :delete, turbo_confirm: 'Are you sure you would like to delete this post?' } %>
      <% end %>
    </div>
  </div>
<% end %>
